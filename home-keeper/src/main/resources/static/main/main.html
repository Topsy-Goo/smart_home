<div style="margin: 10px;">
	<h5>Список устройств, подключеных к Умному дому.</h5>
	<p>&nbsp;</p>

	{{home_dto.string}}
	<br>
	<br><button ng-click="timerStop()">Таймер стоп</button>
	<br>

<br>
	<div ng-repeat="type_group in home_dto.groups"><!-- HTML-контейнер для устройств одного типа -->
		<h4 align="center">{{type_group.typeName}}</h4>
		<div ng-repeat="device in type_group.devices" class="device_panel"><!-- ng-repeat работатет в <div>, но не работает в <table> -->
<!-- Часть панели, которая видна всегда — заголовок панели. -->
			<div><!-- ng-init="deviceState=getState(device.abilities.uuid)"  ng-model="deviceCurrentState=getDeviceState(device.abilities.uuid)" -->
				<table class="table table-striped margin_bottom_0">
					<tr><td class="col-3">{{device.friendlyName}}</td>
<!--						<td class="col-2">{{deviceState.opCode}}<br>
										  {{deviceState.errCode}}</td>-->
						<td class="col-2">{{device.state.opCode}}<br>
										  {{device.state.errCode}}</td>
<!--						<td class="col-5">{{getActiveString(deviceState.active)}}<br>
										  {{deviceState.currentTask.name}} ({{deviceState.currentTask.tstate}})</td>-->
						<td class="col-5">{{getActiveString(device.state.active)}}<br>
										  {{device.state.currentTask.name}} ({{device.state.currentTask.tstate}})</td>
						<td class="col-2">
							<!-- Кнопка Активировать/Деактивировать устройство. -->
							<button class="btn btn-outline-primary btn-sm justify-end"
									title="Активировать/Деактивировать устройство"
									ng-click="toggleDeviceActiveState(device.abilities.uuid)">
<!--								{{getButtonNameActivate(deviceState.active)}}-->
								{{getButtonNameActivate(device.state.active)}}
							</button>
							<br>
							<!-- Кнопка Показать/Скрыть панель устройства. -->
							<button class="btn btn-outline-primary btn-sm justify-end"
									title="Показать/Скрыть панель устройства"
									ng-click="togglePanelOpenedState(device.abilities.uuid)">
								{{getButtonNameShowPanel(device.abilities.uuid)}}
							</button><!--  -->
						</td>
					</tr>
				</table>
			</div>
<!-- Часть панели, которая может быть скрыта. -->
			<div class="almost_windows" ng-show="isPanelOpened(device.abilities.uuid)"><!--  -->
				<!-- <img src="img/Steampunk.jpg" alt="JPG">-->
				<ul><li>device.abilities.deviceType : {{device.abilities.deviceType}}</li>
					<li>device.abilities.vendorName : {{device.abilities.vendorName}}</li>
					<li>device.abilities.uuid : 	  {{device.abilities.uuid}}</li><!--  -->
					<li>device.abilities.canSleep :   {{device.abilities.canSleep}}</li>
					<li style="width: 100%;">
<!-- Форма для выбора задачи из списка доступных задач. -->
						<form class="align-middle col-12" ng-submit="launchTask(device.abilities.uuid,taskToLaunch)">
							<div class="input-group-sm" style="margin-left: -15px;">
								device.abilities.tasks&nbsp;:&nbsp;
								<select	id="taskList"	name="taskList"
										class="form-select-sm"
                                		style="margin-left: 10px; padding: 2px; border-color: #aaaadd; border-radius: 3px; border-width: 2px;"
										required="required"
										ng-model="taskToLaunch"
										title="Выберете задачу, которую хотите запустить.">
									<option selected></option>
									<option ng-repeat="tsk in device.abilities.tasks"
											value="{{tsk.name}}">{{tsk.name}} ({{tsk.duration/60}} мин.)
									</option>
								</select>
								<button id="taskSubmit"
										class="btn-sm btn-outline-warning"
										style="margin-left: 10px;"
										type="submit"
										title="Запустить выбраную задачу.">Запустить</button>
								<button id="taskSchedule"
										class="btn-sm btn-outline-default"
										style="margin-left: 10px;"
										ng-click="scheduleTask(device.abilities.uuid,taskToLaunch)"
										title="Запланировать запуск выбраной задачи.">Запланировать</button>
							</div>
						</form>
					</li>
<!--				<li>device.state.active :  {{device.state.active}}</li>
					<li>device.state.opCode :  {{device.state.opCode}}</li>
					<li>device.state.errCode : {{device.state.errCode}}</li>-->
					<!-- Текущая задача. -->
					<li>device.state.currentTask :<!--  <span ng-show="device.state.currentTask.remained <= 0">(нет текущих задач)</span> -->
<!-- Описание состояния УУ. -->
						<select class="form-select col-12" size="5"><!-- ng-show="device.state.currentTask.remained > 0"  -->
							<!--<option selected></option>-->
							<option value="{{device.state.currentTask.name}}"			>device.state.currentTask.name : 		  {{device.state.currentTask.name}}			</option>
							<option value="{{device.state.currentTask.tstate}}"			>device.state.currentTask.tstate : 		  {{device.state.currentTask.tstate}}		</option>
							<option value="{{device.state.currentTask.autonomic}}"		>device.state.currentTask.autonomic : 	  {{device.state.currentTask.autonomic}}		</option>
							<option value="{{device.state.currentTask.interruptible}}"	>device.state.currentTask.interruptible : {{device.state.currentTask.interruptible}}	</option>
							<option value="{{device.state.currentTask.duration}}"		>device.state.currentTask.duration : 	  {{device.state.currentTask.duration}}		</option>
							<option value="{{device.state.currentTask.remained}}"		>device.state.currentTask.remained : 	  {{device.state.currentTask.remained}}		</option>
							<option value="{{device.state.currentTask.elapsed}}"		>device.state.currentTask.elapsed : 	  {{device.state.currentTask.elapsed}}		</option>
							<option value="{{device.state.currentTask.message}}"		>device.state.currentTask.message : 	  {{device.state.currentTask.message}}		</option>
						</select><!--  size="5"  aria-label="size 3 select example" -->
					</li>
<!-- Форма для изменения device.friendlyName. -->
					<li><form class="align-middle col-12" ng-submit="tryNewFriendlyName(device, newFriendlyName)">
							<div class="input-group input-group-sm" style="margin-left: -15px;">
								device.friendlyName&nbsp;:&nbsp;{{device.friendlyName}}&nbsp;
								<input	id="friendlyNameInput"
                                		class="form-control form-control-sm"
                                		style="margin-left: 10px;"
                                		type="text"
										ng-model="newFriendlyName"
										required="required"
										><!--   input-group     -->
								<button	id="friendlyNameSubmit"
                                		class="btn btn-sm btn-outline-warning"
                                		style="margin-left: 10px;"
                                		type="submit"
                                		>Запомнить</button>
							</div>
						</form>
					</li>
<!--				<li><form>
							<input	id="inp" type="text" required="required">
							<button>Ok</button>
						</form>
					</li>-->
					<!--<li>device.htmlPanelOpened&nbsp;:&nbsp;{{device.htmlPanelOpened}}</li>-->
				</ul>
			</div>
		</div>
	</div>
	<br><br>

<!--	<button class="btn btn-primary btn-sm" >Управление устройствами</button>-->

<!--	<table class="table table-success table-striped margin_bottom_0">
		<thead class="table-dark">
			<tr>
				<th>
					(заголовок к рабочей области устройства)
				</th>
			</tr>
		</thead>
		<tbody>
			<tr><td>
					(рабочая область)
				</td>
			</tr>
		</tbody>
		<tfoot class="table-primary">
			<tr>
				<td>
					(футер к рабочей области устройства)
				</td>
			</tr>
		</tfoot>
	</table>-->

<!-- Конец экспериментальной части. -->
</div>